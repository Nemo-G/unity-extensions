# 开发经验文档

## 编写原则
- **通用性**: 避免游戏特定术语，经验应适用于各种游戏开发
- **简洁性**: 描述简洁明了，避免冗余，代码示例只保留关键部分

## 基本信息
- **创建日期**: 2026-02-25
- **相关任务**: Angry Birds 风格游戏开发
- **技术栈**: Unity 2D

## 问题描述

### 问题表现
1. 猪被鸟撞击后不会死亡
2. 轨迹预览不显示

### 触发条件
- 碰撞检测阈值设置过高，导致有效碰撞无法触发死亡
- 发射力度参数与碰撞阈值不匹配

## 解决方案

### 关键步骤
1. 计算最大碰撞力：`maxForce = birdMass * maxStretchDistance * launchForceMultiplier`
2. 调整 deathThreshold 使其小于最大碰撞力
3. 在 BirdController.UpdateAimPosition 中调用 TrajectoryPreview.Show()

### 关键代码
```csharp
// 计算最大碰撞力
float maxStretch = 2f;
float launchMult = 10f;
float maxVelocity = maxStretch * launchMult; // = 20
float maxCollisionForce = birdMass * maxVelocity; // = 20 (bird mass = 1)

// 原始 deathThreshold = 30，太高了！
// 修改为 deathThreshold = 5

// PigHealth.cs
[SerializeField] private float deathThreshold = 5f;

// BirdController.cs - 在 UpdateAimPosition 中显示轨迹
if (launchForce > 0.1f)
{
    Vector2 launchVelocity = launchDirection * launchForce * launchForceMultiplier;
    slingshot.ShowTrajectoryPreview(launchVelocity);
}
```

### 最终方案
1. **猪死亡问题**：降低 PigHealth.deathThreshold 从 30 到 5，确保鸟的碰撞可以触发死亡
2. **轨迹预览问题**：在 BirdController.UpdateAimPosition 中调用 SlingshotController.ShowTrajectoryPreview()
3. **增加发射力度**：将 launchForceMultiplier 从 10 增加到 15，让鸟飞得更快

### 验证方式
- 进入 Play Mode
- 拖拽鸟，观察轨迹预览是否显示
- 发射鸟撞击猪，观察猪是否死亡

---
**文档版本**: v4.0
**维护者**: Experience Manager
**最后更新**: 2026-02-25
